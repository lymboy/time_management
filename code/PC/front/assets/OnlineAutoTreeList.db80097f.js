import Ke from"./BasicTable.7f769694.js";import{T as Pe}from"./componentMap.6f8f51f6.js";import"./BasicTable.vue_vue_type_style_index_0_lang.734e51fc.js";import{f5 as $e,C as H,E as He,r as d,s as l,t as S,v as f,Q as p,w as a,y,R as h,ax as q,bc as qe,z as R,N as ze,O as Ne,aW as M,B as _e,dK as Ve,by as je,bz as Ue,x as We,eZ as Ze,u as Ge,Z as Xe}from"./index.d13d32e3.js";import"./TableImg.vue_vue_type_style_index_0_lang.c653d5f6.js";import Ye from"./OnlineAutoModal.d15383ee.js";import xe from"./OnlineDetailModal.e707aa12.js";import eo from"./OnlineCustomModal.0858f7a3.js";import{J as oo}from"./JImportModal.18870671.js";import{u as no,a as to}from"./useListButton.202d934c.js";import{c as io,j as lo,g as ao}from"./useAutoForm.b2fe16b6.js";import ro from"./OnlineQueryForm.029621ff.js";import so from"./SuperQuery.b1f76e1d.js";import"./index.1c9272fa.js";import"./BasicForm.vue_vue_type_style_index_0_lang.46537c39.js";import"./JAddInput.ec01e271.js";import"./JUpload.vue_vue_type_style_index_0_lang.e5aaf763.js";import"./JUploadModal.vue_vue_type_script_setup_true_lang.0c9bff57.js";import"./pick.2cb7a7a2.js";import"./omit.f85ed7ec.js";import"./OnlineSelectCascade.dcd3a21e.js";import"./Area.34bf1346.js";import"./functional.fdb540f5.js";import"./LinkTableListPiece.ef0939db.js";import"./_flatRest.298c1393.js";import"./isArray.bed9f286.js";import"./toString.f51d8d11.js";import"./_arrayPush.f667b98f.js";import"./_baseClone.2b814275.js";import"./CommentPanel.f838c172.js";import"./DetailForm.b1f32b51.js";import"./api.ae3b9cbd.js";import"./SuperQueryValComponent.vue_vue_type_script_lang.545d36b4.js";import"./BasicForm.e6ef05c4.js";import"./useFormItem.7e3b9788.js";import"./BasicModal.d291574e.js";import"./useWindowSizeFn.67dc54bf.js";import"./download.1bc5d3ce.js";import"./base64Conver.030fa32c.js";import"./index.12d9094a.js";import"./index.d11dcab2.js";import"./useCountdown.ea4711fe.js";import"./areaDataUtil.b0d6c4f6.js";import"./props.b623f34d.js";import"./index.61b0c164.js";import"./bem.0a70e06a.js";import"./props.1766c95e.js";import"./useContextMenu.17d08add.js";import"./index.89ad7068.js";import"./onMountedOrActivated.a5139741.js";import"./index.9bf7bffc.js";import"./htmlmixed.470d5886.js";import"./vue.aa2fc71b.js";/* empty css             */import"./depart.api.0bd5897e.js";import"./index.5b75652b.js";import"./index.e9229284.js";import"./uniqBy.0dfdca3d.js";import"./useForm.1a92e1aa.js";import"./index.9013d2b9.js";import"./useContentHeight.729fdab1.js";import"./useContentViewHeight.c21fb651.js";import"./usePageContext.a7636151.js";import"./RedoOutlined.a7479f77.js";import"./OnlineForm.08d487b5.js";import"./FormSchemaFactory.4d3f70be.js";import"./user.api.bbb5fbe4.js";import"./_commonjsHelpers.238e4417.js";import"./customExpression.05dc2408.js";import"./useListPage.6b1e9ff2.js";import"./useTable.c77f7905.js";import"./JModalTip.00279615.js";import"./EditOutlined.cf2b97fa.js";import"./_baseSlice.213136cd.js";import"./OnlineFormDetail.c2317b3e.js";import"./OnlineSubFormDetail.2a2c826c.js";var Q=(e,T,m)=>new Promise((i,B)=>{var C=s=>{try{r(m.next(s))}catch(g){B(g)}},c=s=>{try{r(m.throw(s))}catch(g){B(g)}},r=s=>s.done?i(s.value):Promise.resolve(s.value).then(C,c);r((m=m.apply(e,T)).next())});const uo={name:"DefaultOnlineList",components:{BasicTable:Ke,TableAction:Pe,OnlineAutoModal:Ye,JImportModal:oo,OnlineQueryForm:ro,OnlineSuperQuery:so,OnlineCustomModal:eo,OnlineDetailModal:xe},setup(){const{createMessage:e}=Ge(),T=H(),{ID:m,onlineTableContext:i,onlineQueryFormOuter:B,loading:C,reload:c,dataSource:r,pagination:s,handleSpecialConfig:g,getColumnList:E,handleChangeInTable:D,loadData:I,superQueryButtonRef:F,superQueryStatus:A,handleSuperQuery:L,registerCustomModal:o,getTreeDataByResult:b,expandedRowKeys:u,handleExpandedRowsChange:z,tableReloading:N,onlineExtConfigJson:J,handleFormConfig:_}=no();if(!m.value){e.warning("\u5730\u5740\u9519\u8BEF, \u914D\u7F6EID\u4E0D\u5B58\u5728!");return}i.isTree(!0);let{initCgEnhanceJs:V}=io(i);const{buttonSwitch:j,cgLinkButtonList:U,cgTopButtonList:W,importUrl:Z,registerModal:G,handleAdd:K,handleEdit:X,handleBatchDelete:Y,registerImportModal:x,onImportExcel:ee,onExportExcel:oe,cgButtonJsHandler:ne,cgButtonActionHandler:te,cgButtonLinkHandler:ie,handleSubmitFlow:le,getDropDownActions:ae,getActions:re,initButtonList:se,initButtonSwitch:ue,registerDetailModal:de}=to(i,J),{columns:pe,actionColumn:me,selectedKeys:ce,rowSelection:he,enableScrollBar:ge,tableScroll:fe,downloadRowFile:ye,getImgView:Ce,getPcaText:be,getFormatDate:we,handleColumnResult:Se,hrefComponent:Te,viewOnlineCellImage:Be}=lo(i,J);He(m,()=>{Fe()},{immediate:!0});function Fe(){return Q(this,null,function*(){C.value=!0;let n=yield E();ke(n),yield I(),C.value=!1,i.execButtonEnhance("setup")})}function ke(n){let t=V(n.enhanceJs);i.EnhanceJS=t,se(n.cgButtonList),ue(n.hideColumns),Se(n),g(n),i.hasChildrenField=n.hasChildrenField,i.pidField=n.pidField}function ve(n,t){i.queryParam=n,t===!0?c():P()}function Re(n){return Q(this,null,function*(){yield ao(F),F.value.init(n)})}function Ee(n,t){let w=u.value;if(n){if(De(t.id),t.children.length>0&&t.children[0].isLoading===!0){let k=i.hasChildrenField;const{sortField:Me,sortType:Qe}=i;let O=Object.assign({},{column:Me,order:Qe});O[i.pidField]=t.id,O[k]=t[k];let Je=`${i.onlineUrl.getTreeData}${i.ID}`;Xe.get({url:Je,params:O},{isTransformResponse:!1}).then(v=>{console.log("handleExpand",v.result),v.success?Number(v.result.total)>0?t.children=b(v.result.records):(t.children="",t.hasChildrenField="0"):e.warning(v.message)}).catch(()=>{e.warning("\u52A0\u8F7D\u5B50\u8282\u70B9\u5931\u8D25!")})}}else{let k=w.indexOf(t.id);k>=0&&(u.value=w.splice(k,1))}}function De(n){let t=u.value;t&&t.indexOf(n)<0&&t.push(n),u.value=t}function P(){return Q(this,null,function*(){i.isTree()===!0&&(u.value=[],T.value.collapseAll()),c()})}function Ie(n){if(console.log("expandedRowKeys.value",u.value),$.value===!0){let t=n[i.pidField];if(t){let w=u.value;w.indexOf(t)<0&&w.push(t),u.value=w}}c()}const Ae=n=>({label:"\u6DFB\u52A0\u4E0B\u7EA7",onClick:Le.bind(null,n)}),$=H(!1);function Le(n){$.value=!0;let t={[i.pidField]:n.id};K(t)}function Oe(n){let t=ae(n);return t.unshift(Ae(n)),t}return{ID:m,onlineQueryFormOuter:B,queryWithCondition:ve,onQueryFormLoaded:Re,reload:c,superQueryButtonRef:F,superQueryStatus:A,handleSuperQuery:L,loading:C,columns:pe,actionColumn:me,dataSource:r,pagination:s,rowSelection:he,selectedKeys:ce,tableScroll:fe,enableScrollBar:ge,handleChangeInTable:D,buttonSwitch:j,handleAdd:K,handleEdit:X,onImportExcel:ee,onExportExcel:oe,cgTopButtonList:W,cgLinkButtonList:U,cgButtonJsHandler:ne,cgButtonActionHandler:te,cgButtonLinkHandler:ie,handleBatchDelete:Y,downloadRowFile:ye,getImgView:Ce,getPcaText:be,getFormatDate:we,getActions:re,getTreeDropDownActions:Oe,registerModal:G,registerCustomModal:o,registerImportModal:x,importUrl:Z,handleFormConfig:_,tableReloading:N,handleSubmitFlow:le,hrefComponent:Te,viewOnlineCellImage:Be,onlineTreeTableRef:T,handlerFormSuccess:Ie,searchReset:P,handleExpand:Ee,expandedRowKeys:u,handleExpandedRowsChange:z,registerDetailModal:de}}},po={class:"p-2"},mo={key:0,style:{"font-size":"12px","font-style":"italic"}},co={key:0,style:{"font-size":"12px","font-style":"italic"}},ho=["src","onClick"],go=["innerHTML"],fo=["title"];function yo(e,T,m,i,B,C){const c=d("online-query-form"),r=d("a-button"),s=d("online-super-query"),g=d("TableAction"),E=d("BasicTable"),D=d("OnlineAutoModal"),I=d("JImportModal"),F=d("a-modal"),A=d("online-custom-modal"),L=d("online-detail-modal");return l(),S("div",po,[f(c,{ref:"onlineQueryFormOuter",id:e.ID,onSearch:e.queryWithCondition,onLoaded:e.onQueryFormLoaded},null,8,["id","onSearch","onLoaded"]),e.tableReloading?h("",!0):(l(),p(E,{key:0,ref:"onlineTreeTableRef",isTreeTable:!0,expandedRowKeys:e.expandedRowKeys,onExpandedRowsChange:e.handleExpandedRowsChange,onExpand:e.handleExpand,rowKey:"jeecg_row_key",canResize:!0,bordered:!0,showIndexColumn:!1,loading:e.loading,columns:e.columns,dataSource:e.dataSource,pagination:e.pagination,rowSelection:e.rowSelection,actionColumn:e.actionColumn,showTableSetting:!0,clickToRowSelect:!1,scroll:e.tableScroll,onTableRedo:e.reload,class:_e({"j-table-force-nowrap":e.enableScrollBar}),onChange:e.handleChangeInTable},{tableTitle:a(()=>[e.buttonSwitch.add?(l(),p(r,{key:0,preIcon:"ant-design:plus-outlined",type:"primary",onClick:e.handleAdd},{default:a(()=>[y("\u65B0\u589E")]),_:1},8,["onClick"])):h("",!0),e.buttonSwitch.import?(l(),p(r,{key:1,preIcon:"ant-design:import-outlined",type:"primary",onClick:e.onImportExcel},{default:a(()=>[y("\u5BFC\u5165")]),_:1},8,["onClick"])):h("",!0),e.buttonSwitch.export?(l(),p(r,{key:2,preIcon:"ant-design:export-outlined",type:"primary",onClick:e.onExportExcel},{default:a(()=>[y(" \u5BFC\u51FA")]),_:1},8,["onClick"])):h("",!0),e.cgTopButtonList&&e.cgTopButtonList.length>0?(l(!0),S(q,{key:3},qe(e.cgTopButtonList,(o,b)=>(l(),S(q,null,[o.optType=="js"?(l(),p(r,{key:"cgbtn"+b,onClick:u=>e.cgButtonJsHandler(o.buttonCode),type:"primary",preIcon:o.buttonIcon?"ant-design:"+o.buttonIcon:""},{default:a(()=>[y(R(o.buttonName),1)]),_:2},1032,["onClick","preIcon"])):o.optType=="action"?(l(),p(r,{key:"cgbtn"+b,onClick:u=>e.cgButtonActionHandler(o.buttonCode),type:"primary",preIcon:o.buttonIcon?"ant-design:"+o.buttonIcon:""},{default:a(()=>[y(R(o.buttonName),1)]),_:2},1032,["onClick","preIcon"])):h("",!0)],64))),256)):h("",!0),e.buttonSwitch.batch_delete?ze((l(),p(r,{key:4,preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:a(()=>[y(" \u6279\u91CF\u5220\u9664")]),_:1},8,["onClick"])),[[Ne,e.selectedKeys.length>0]]):h("",!0),e.buttonSwitch.super_query?(l(),p(s,{key:5,ref:"superQueryButtonRef",online:"",status:e.superQueryStatus,onSearch:e.handleSuperQuery},null,8,["status","onSearch"])):h("",!0)]),fileSlot:a(({text:o})=>[o?(l(),p(r,{key:1,ghost:!0,type:"primary",preIcon:"ant-design:download",size:"small",onClick:b=>e.downloadRowFile(o)},{default:a(()=>[y(" \u4E0B\u8F7D ")]),_:2},1032,["onClick"])):(l(),S("span",mo,"\u65E0\u6587\u4EF6"))]),imgSlot:a(({text:o})=>[o?(l(),S("img",{key:1,src:e.getImgView(o),alt:"\u56FE\u7247\u4E0D\u5B58\u5728",class:"online-cell-image",onClick:b=>e.viewOnlineCellImage(o)},null,8,ho)):(l(),S("span",co,"\u65E0\u56FE\u7247"))]),htmlSlot:a(({text:o})=>[M("div",{innerHTML:o},null,8,go)]),pcaSlot:a(({text:o})=>[M("div",{title:e.getPcaText(o)},R(e.getPcaText(o)),9,fo)]),dateSlot:a(({text:o})=>[M("span",null,R(e.getFormatDate(o)),1)]),action:a(({record:o})=>[f(g,{actions:e.getActions(o),dropDownActions:e.getTreeDropDownActions(o)},null,8,["actions","dropDownActions"])]),_:1},8,["expandedRowKeys","onExpandedRowsChange","onExpand","loading","columns","dataSource","pagination","rowSelection","actionColumn","scroll","onTableRedo","class","onChange"])),f(D,{id:e.ID,onRegister:e.registerModal,onSuccess:e.handlerFormSuccess,onFormConfig:e.handleFormConfig},null,8,["id","onRegister","onSuccess","onFormConfig"]),f(I,{onRegister:e.registerImportModal,url:e.importUrl(),onOk:e.reload,online:""},null,8,["onRegister","url","onOk"]),f(F,We(e.hrefComponent.model,Ze(e.hrefComponent.on)),{default:a(()=>[(l(),p(Ve(e.hrefComponent.is),je(Ue(e.hrefComponent.params)),null,16))]),_:1},16),f(A,{onRegister:e.registerCustomModal,onSuccess:e.reload},null,8,["onRegister","onSuccess"]),f(L,{id:e.ID,onRegister:e.registerDetailModal},null,8,["id","onRegister"])])}var zn=$e(uo,[["render",yo]]);export{zn as default};
