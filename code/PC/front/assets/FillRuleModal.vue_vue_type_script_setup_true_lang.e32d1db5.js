var I=Object.defineProperty;var C=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var h=(e,u,l)=>u in e?I(e,u,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[u]=l,g=(e,u)=>{for(var l in u||(u={}))y.call(u,l)&&h(e,l,u[l]);if(C)for(var l of C(u))w.call(u,l)&&h(e,l,u[l]);return e};var F=(e,u,l)=>new Promise((a,r)=>{var d=s=>{try{c(l.next(s))}catch(p){r(p)}},o=s=>{try{c(l.throw(s))}catch(p){r(p)}},c=s=>s.done?a(s.value):Promise.resolve(s.value).then(d,o);c((l=l.apply(e,u)).next())});import{B as P}from"./index.1c9272fa.js";import{B as b}from"./BasicForm.e6ef05c4.js";import"./componentMap.6f8f51f6.js";import{u as _}from"./useForm.1a92e1aa.js";import"./JAddInput.ec01e271.js";import{Z as i,a2 as x,j as D,m as E,K as n,C as M,bH as k,s as N,Q as T,w as U,v as V,x as v}from"./index.d13d32e3.js";import{d as A}from"./user.api.bbb5fbe4.js";const Z=[{title:"\u89C4\u5219\u540D\u79F0",dataIndex:"ruleName",width:200,align:"center"},{title:"\u89C4\u5219\u7F16\u7801",dataIndex:"ruleCode",width:200,align:"center"},{title:"\u89C4\u5219\u5B9E\u73B0\u7C7B",dataIndex:"ruleClass",width:300,align:"center"},{title:"\u89C4\u5219\u53C2\u6570",dataIndex:"ruleParams",width:200,align:"center"}],$=[{field:"ruleName",label:"\u89C4\u5219\u540D\u79F0",component:"Input",colProps:{span:6}},{field:"ruleCode",label:"\u89C4\u5219\u7F16\u7801",component:"Input",colProps:{span:6}}],L=[{label:"",field:"id",component:"Input",show:!1},{field:"ruleName",label:"\u89C4\u5219\u540D\u79F0",component:"Input",required:!0,colProps:{span:24}},{field:"ruleCode",label:"\u89C4\u5219\u7F16\u7801",component:"Input",colProps:{span:24},dynamicDisabled:({values:e})=>!!e.id,dynamicRules:({model:e})=>[{required:!0,validator:(u,l)=>new Promise((a,r)=>{if(!l)return r("\u8BF7\u8F93\u5165\u89C4\u5219\u7F16\u7801\uFF01");let d={tableName:"sys_fill_rule",fieldName:"rule_code",fieldVal:l,dataId:e.id};A(d).then(o=>{o.success?a():r("\u89C4\u5219\u7F16\u7801\u5DF2\u5B58\u5728!")}).catch(o=>{r(o.message||"\u6821\u9A8C\u5931\u8D25")})})}]},{field:"ruleClass",label:"\u89C4\u5219\u5B9E\u73B0\u7C7B",component:"Input",required:!0,colProps:{span:24}},{field:"ruleParams",label:"\u89C4\u5219\u53C2\u6570",colProps:{span:24},component:"JAddInput",componentProps:{min:0}}],z="/sys/fillRule/exportXls",W="/sys/fillRule/importExcel",Y=e=>i.get({url:"/sys/fillRule/list",params:e}),ee=(e,u)=>i.delete({url:"/sys/fillRule/delete",data:e},{joinParamsToUrl:!0}).then(()=>{u()}),le=(e,u)=>{x.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u662F\u5426\u5220\u9664\u9009\u4E2D\u6570\u636E",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:()=>i.delete({url:"/sys/fillRule/deleteBatch",data:e},{joinParamsToUrl:!0}).then(()=>{u()})})},ue=e=>i.get({url:"/sys/fillRule/testFillRule",params:e},{isTransformResponse:!1}),q=e=>i.post({url:"/sys/fillRule/add",params:e}),O=e=>i.put({url:"/sys/fillRule/edit",params:e}),te=D({__name:"FillRuleModal",emits:["register","success"],setup(e,{emit:u}){const l=E(()=>n(a)?"\u7F16\u8F91":"\u65B0\u589E"),a=M(!0),[r,{resetFields:d,setFieldsValue:o,validate:c,getFieldsValue:s}]=_({schemas:L,showActionButtonGroup:!1,baseColProps:{span:12}}),[p,{setModalProps:m,closeModal:R}]=k(t=>F(this,null,function*(){yield d(),m({confirmLoading:!1}),a.value=!!(t!=null&&t.isUpdate),n(a)&&(yield o(g({},t.record)))}));function B(){return F(this,null,function*(){try{let t=yield c();if(m({confirmLoading:!0}),a.value){let f=s();!t.parentId&&f.parentId&&(t.parentId=f.parentId),yield O(t)}else yield q(t);R(),u("success")}finally{m({confirmLoading:!1})}})}return(t,f)=>(N(),T(n(P),v(t.$attrs,{onRegister:n(p),title:n(l),onOk:B,width:800,destroyOnClose:""}),{default:U(()=>[V(n(b),{onRegister:n(r)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{te as _,le as b,Z as c,ee as d,z as e,Y as g,ue as h,W as i,$ as s};
