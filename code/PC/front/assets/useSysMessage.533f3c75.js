var m=(g,r,t)=>new Promise((y,i)=>{var d=u=>{try{c(t.next(u))}catch(f){i(f)}},o=u=>{try{c(t.throw(u))}catch(f){i(f)}},c=u=>u.done?y(u.value):Promise.resolve(u.value).then(d,o);c((t=t.apply(g,r)).next())});import{b as C,e3 as E,D as B,e4 as S,e5 as h,C as v,a8 as T,Z as F}from"./index.d13d32e3.js";const w=g=>{const r="/sys/annountCement/vue3List";return F.get({url:r,params:g})};function P(){const g=C("rangeDate");console.log("+++++++++++++++++++++"),console.log("rangeDateArray",g),console.log("+++++++++++++++++++++");const r=v([]),t=v(1);let y=10;const i=T({fromUser:"",rangeDateKey:"",rangeDate:[],starFlag:""});function d(){let{fromUser:e,rangeDateKey:a,rangeDate:s,starFlag:l}=i,D={fromUser:e,starFlag:l,rangeDateKey:a,beginDate:"",endDate:"",pageNo:t.value,pageSize:y};return a=="zdy"&&(D.beginDate=s[0]+" 00:00:00",D.endDate=s[1]+" 23:59:59"),D}const o=v(!1);function c(){return m(this,null,function*(){if(o.value===!0)return;let e=d();const a=yield w(e);if(console.log("\u83B7\u53D6\u7ED3\u679C",a),!a||a.length<=0){o.value=!0;return}a.length<y&&(o.value=!0),t.value=t.value+1;let s=r.value;s.push(...a),r.value=s})}function u(){r.value=[],t.value=1,o.value=!1}function f(e){const a="/sys/sysAnnouncementSend/edit";let s="1";e.starFlag==s&&(s="0");const l={starFlag:s,id:e.sendId};F.put({url:a,params:l})}const n=v(!1);function p(){return m(this,null,function*(){n.value=!0,yield c(),n.value=!1})}function b(e){return e.readFlag!=="1"}function A(e){return e.busType=="email"?"\u90AE\u4EF6\u63D0\u9192:":e.busType=="bpm"?"\u6D41\u7A0B\u50AC\u529E:":e.busType=="bpm_task"?"\u6D41\u7A0B\u4EFB\u52A1:":e.msgCategory=="2"?"\u7CFB\u7EDF\u6D88\u606F:":e.msgCategory=="1"?"\u901A\u77E5\u516C\u544A:":""}return{messageList:r,reset:u,loadData:c,loadEndStatus:o,searchParams:i,updateStarMessage:f,onLoadMore:p,noRead:b,getMsgCategory:A}}function H(g){const r=C("messageHref"),t=E(),y=B(),i=S(),{close:d,closeSameRoute:o}=h();function c(n,p){return m(this,null,function*(){n.busType?yield u(n):p?p():yield f(n)})}function u(n){return m(this,null,function*(){const{busType:p,busId:b,msgAbstract:A}=n;let e=r.filter(l=>l.value===p);if(!e||e.length==0){console.error("\u5F53\u524D\u4E1A\u52A1\u7C7B\u578B\u4E0D\u8BC6\u522B",p);return}let a=e[0].text;a=a.replace("{DETAIL_ID}",b);let s={detailId:b};if(A)try{let l=JSON.parse(A);Object.keys(l).map(D=>{s[D]=l[D]})}catch(l){console.error("msgAbstract\u53C2\u6570\u4E0D\u662FJSON\u683C\u5F0F",A)}y.setMessageHrefParams(s),i.path.indexOf(a)>=0?(yield d(),yield t.replace({path:a,query:{time:new Date().getTime()}})):(o(a),yield t.push({path:a}))})}function f(n){return m(this,null,function*(){g("detail",n)})}return{goPage:c}}export{P as a,H as u};
