var A=(t,r,c)=>new Promise((F,_)=>{var B=a=>{try{o(c.next(a))}catch(f){_(f)}},s=a=>{try{o(c.throw(a))}catch(f){_(f)}},o=a=>a.done?F(a.value):Promise.resolve(a.value).then(B,s);o((c=c.apply(t,r)).next())});import{B as Y}from"./index.1c9272fa.js";import{s as $}from"./jvxetable.api.5fa182b2.js";import{o as I,a as q}from"./api.39b3477f.js";import{j as N,C as U,a8 as E,bH as H,m as S,K as O,q as V,r as i,s as C,Q as b,w as u,v as e,y as d,aW as z,t as h,ax as j,bc as T,x as K}from"./index.d13d32e3.js";import"./BasicModal.d291574e.js";import"./useWindowSizeFn.67dc54bf.js";const P=N({name:"tableModal",components:{BasicModal:Y},emits:["success","register"],setup(t,{emit:r}){const c=U(!0),F=U(""),_=U(),B=E({xs:{span:24},sm:{span:5}}),s=E({xs:{span:24},sm:{span:16}}),o={orderCode:[{required:!0,message:"\u8BA2\u5355\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]},a=E({id:null,orderCode:"",orderMoney:"",ctype:"",content:"",jeecgOrderCustomerList:[],jeecgOrderTicketList:[]}),[f,{setModalProps:v,closeModal:M}]=H(l=>A(this,null,function*(){if(v({confirmLoading:!1}),c.value=!!(l!=null&&l.isUpdate),k(),O(c)){F.value=l.record.id,Object.assign(a,l.record);let p={id:a.id};const n=yield I(p);a.jeecgOrderCustomerList=n;const R=yield q(p);a.jeecgOrderTicketList=R}})),m=S(()=>O(c)?"\u7F16\u8F91":"\u65B0\u589E");function g(){a.jeecgOrderCustomerList.push({})}function y(l){a.jeecgOrderCustomerList.splice(l,1),a.jeecgOrderCustomerList.splice(l,1)}function k(){a.id=null,a.orderCode="",a.orderMoney="",a.orderDate=null,a.ctype="",a.content="",a.jeecgOrderCustomerList=[],a.jeecgOrderTicketList=[]}function D(){a.jeecgOrderTicketList.push({})}function w(l){a.jeecgOrderTicketList.splice(l,1),a.jeecgOrderTicketList.splice(l,1)}function L(){return A(this,null,function*(){_.value.validate().then(()=>A(this,null,function*(){try{console.log("formData",JSON.stringify(a)),v({confirmLoading:!0}),yield $(a,O(c)),M(),r("success")}finally{v({confirmLoading:!1})}})).catch(l=>{console.log("error",l)})})}return{formRef:_,validatorRules:o,orderMainModel:a,registerModal:f,getTitle:m,labelCol:B,wrapperCol:s,addRowCustom:g,delRowCustom:y,addRowTicket:D,delRowTicket:w,handleSubmit:L}}});function J(t,r,c,F,_,B){const s=i("a-input"),o=i("a-form-item"),a=i("a-col"),f=i("a-select-option"),v=i("a-select"),M=i("a-date-picker"),m=i("a-row"),g=i("Icon"),y=i("a-button"),k=i("a-tab-pane"),D=i("a-tabs"),w=i("a-form"),L=i("BasicModal");return C(),b(L,K(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit,width:"70%"}),{default:u(()=>[e(w,{ref:"formRef",model:t.orderMainModel,"label-col":t.labelCol,"wrapper-col":t.wrapperCol,rules:t.validatorRules},{default:u(()=>[e(m,{class:"form-row",gutter:16},{default:u(()=>[e(a,{lg:8},{default:u(()=>[e(o,{label:"\u8BA2\u5355\u53F7",name:"orderCode"},{default:u(()=>[e(s,{value:t.orderMainModel.orderCode,"onUpdate:value":r[0]||(r[0]=l=>t.orderMainModel.orderCode=l),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7"},null,8,["value"])]),_:1})]),_:1}),e(a,{lg:8},{default:u(()=>[e(o,{label:"\u8BA2\u5355\u7C7B\u578B"},{default:u(()=>[e(v,{placeholder:"\u8BF7\u9009\u62E9\u8BA2\u5355\u7C7B\u578B",value:t.orderMainModel.ctype,"onUpdate:value":r[1]||(r[1]=l=>t.orderMainModel.ctype=l)},{default:u(()=>[e(f,{value:"1"},{default:u(()=>[d("\u56FD\u5185\u8BA2\u5355")]),_:1}),e(f,{value:"2"},{default:u(()=>[d("\u56FD\u9645\u8BA2\u5355")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(a,{lg:8},{default:u(()=>[e(o,{label:"\u8BA2\u5355\u65E5\u671F"},{default:u(()=>[e(M,{showTime:"",valueFormat:"YYYY-MM-DD HH:mm:ss",value:t.orderMainModel.orderDate,"onUpdate:value":r[2]||(r[2]=l=>t.orderMainModel.orderDate=l)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(m,{class:"form-row",gutter:16},{default:u(()=>[e(a,{lg:8},{default:u(()=>[e(o,{label:"\u8BA2\u5355\u91D1\u989D"},{default:u(()=>[e(s,{value:t.orderMainModel.orderMoney,"onUpdate:value":r[3]||(r[3]=l=>t.orderMainModel.orderMoney=l),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u91D1\u989D"},null,8,["value"])]),_:1})]),_:1}),e(a,{lg:8},{default:u(()=>[e(o,{label:"\u8BA2\u5355\u5907\u6CE8"},{default:u(()=>[e(s,{value:t.orderMainModel.content,"onUpdate:value":r[4]||(r[4]=l=>t.orderMainModel.content=l),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(D,{defaultActiveKey:"1"},{default:u(()=>[e(k,{tab:"\u5BA2\u6237\u4FE1\u606F",key:"1"},{default:u(()=>[z("div",null,[e(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16},{default:u(()=>[e(a,{span:5},{default:u(()=>[d("\u5BA2\u6237\u540D")]),_:1}),e(a,{span:5},{default:u(()=>[d("\u6027\u522B")]),_:1}),e(a,{span:6},{default:u(()=>[d("\u8EAB\u4EFD\u8BC1\u53F7\u7801")]),_:1}),e(a,{span:6},{default:u(()=>[d("\u624B\u673A\u53F7")]),_:1}),e(a,{span:2},{default:u(()=>[d("\u64CD\u4F5C")]),_:1})]),_:1}),(C(!0),h(j,null,T(t.orderMainModel.jeecgOrderCustomerList,(l,p)=>(C(),b(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16,key:p},{default:u(()=>[e(a,{span:6,style:{display:"none"}},{default:u(()=>[e(o,null,{default:u(()=>[e(s,{placeholder:"id",value:l.id,"onUpdate:value":n=>l.id=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:5},{default:u(()=>[e(o,null,{default:u(()=>[e(s,{placeholder:"\u5BA2\u6237\u540D",value:l.name,"onUpdate:value":n=>l.name=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:5},{default:u(()=>[e(o,null,{default:u(()=>[e(v,{placeholder:"\u6027\u522B",value:l.sex,"onUpdate:value":n=>l.sex=n},{default:u(()=>[e(f,{value:"1"},{default:u(()=>[d("\u7537")]),_:1}),e(f,{value:"2"},{default:u(()=>[d("\u5973")]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:6},{default:u(()=>[(C(),b(o,{name:["jeecgOrderCustomerList",p,"idcard"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",trigger:"blur"}],key:p},{default:u(()=>[e(s,{placeholder:"\u8EAB\u4EFD\u8BC1\u53F7",value:l.idcard,"onUpdate:value":n=>l.idcard=n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]))]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,{name:["jeecgOrderCustomerList",p,"telphone"]},{default:u(()=>[e(s,{placeholder:"\u624B\u673A\u53F7",value:l.telphone,"onUpdate:value":n=>l.telphone=n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(a,{span:2},{default:u(()=>[e(o,null,{default:u(()=>[e(g,{icon:"ant-design:minus-outlined",onClick:n=>t.delRowCustom(p),style:{fontsize:"20px"}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(y,{type:"dashed",style:{width:"98%","margin-top":"10px"},onClick:t.addRowCustom},{default:u(()=>[e(g,{icon:"ph:plus-bold"}),d(" \u6DFB\u52A0\u5BA2\u6237\u4FE1\u606F ")]),_:1},8,["onClick"])])]),_:1}),e(k,{tab:"\u673A\u7968\u4FE1\u606F",key:"2",forceRender:""},{default:u(()=>[e(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16},{default:u(()=>[e(a,{span:6},{default:u(()=>[d("\u822A\u73ED\u53F7")]),_:1}),e(a,{span:6},{default:u(()=>[d("\u822A\u73ED\u65F6\u95F4")]),_:1}),e(a,{span:6},{default:u(()=>[d("\u64CD\u4F5C")]),_:1})]),_:1}),(C(!0),h(j,null,T(t.orderMainModel.jeecgOrderTicketList,(l,p)=>(C(),b(m,{type:"flex",style:{"margin-bottom":"10px"},gutter:16,key:p},{default:u(()=>[e(a,{span:6,style:{display:"none"}},{default:u(()=>[e(o,null,{default:u(()=>[e(s,{placeholder:"id",value:l.id,"onUpdate:value":n=>l.id=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,{name:["jeecgOrderTicketList",p,"ticketCode"],rules:{required:!0,message:"\u8BF7\u8F93\u5165\u822A\u73ED\u53F7",trigger:"blur"}},{default:u(()=>[e(s,{placeholder:"\u822A\u73ED\u53F7",value:l.ticketCode,"onUpdate:value":n=>l.ticketCode=n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,null,{default:u(()=>[e(M,{placeholder:"\u822A\u73ED\u65F6\u95F4",valueFormat:"YYYY-MM-DD",value:l.tickectDate,"onUpdate:value":n=>l.tickectDate=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(a,{span:6},{default:u(()=>[e(o,null,{default:u(()=>[e(g,{icon:"ant-design:minus-outlined",onClick:n=>t.delRowTicket(p),style:{fontsize:"20px"}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(y,{type:"dashed",style:{width:"98%","margin-top":"10px"},onClick:t.addRowTicket},{default:u(()=>[e(g,{icon:"ph:plus-bold"}),d(" \u6DFB\u52A0\u673A\u7968\u4FE1\u606F ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model","label-col","wrapper-col","rules"])]),_:1},16,["onRegister","title","onOk"])}const ue=V(P,[["render",J],["__scopeId","data-v-3e7918ff"]]);export{ue as default};
