var w=(o,a,d)=>new Promise((m,_)=>{var g=l=>{try{s(d.next(l))}catch(i){_(i)}},p=l=>{try{s(d.throw(l))}catch(i){_(i)}},s=l=>l.done?m(l.value):Promise.resolve(l.value).then(g,p);s((d=d.apply(o,a)).next())});import{B as $}from"./index.1c9272fa.js";import{j as x,C as M,a8 as E,bH as L,K as T,m as R,q as h,r as u,s as U,Q as V,w as t,v as e,y as A,x as O}from"./index.d13d32e3.js";import"./BasicModal.d291574e.js";import"./useWindowSizeFn.67dc54bf.js";const j=x({name:"VexTableModal",components:{BasicModal:$},emits:["success","register"],setup(o,{emit:a}){const d=M(!0),m=M({}),_=M(""),g=M(),p=E({xs:{span:24},sm:{span:5}}),s=E({xs:{span:24},sm:{span:16}}),l=M([{label:"",value:""},{label:"\u7537",value:"1"},{label:"\u5973",value:"2"}]),i={orderCode:[{required:!0,message:"\u8BA2\u5355\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]},f=E({id:null,orderCode:"",orderMoney:"",ctype:"",content:"",jeecgOrderCustomerList:[],jeecgOrderTicketList:[]}),[F,{setModalProps:v,closeModal:B}]=L(n=>w(this,null,function*(){f.orderCode="",v({confirmLoading:!1}),d.value=!!(n!=null&&n.isUpdate),T(d)&&(_.value=n.record.id,f.orderCode=n.record.orderCode)})),y=M([]),c=R(()=>T(d)?"\u7F16\u8F91":"\u65B0\u589E");function D(n){return w(this,null,function*(){const b=m.value,k={name:"",sex:"1",idcard:"",telphone:""},{row:r}=yield b.insertAt(k,n);yield b.setActiveCell(r,"sex")})}function C(){return w(this,null,function*(){g.value.validate().then(()=>{try{const n=m.value,{fullData:b}=n.getTableData();f.jeecgOrderCustomerList=b,console.log("formData",JSON.stringify(f)),v({confirmLoading:!0}),B(),a("success",{isUpdate:T(d),values:{id:_.value}})}finally{v({confirmLoading:!1})}}).catch(n=>{console.log("error",n)})})}return{xTable:m,tableData:y,sexList:l,formRef:g,validatorRules:i,orderMainModel:f,registerModal:F,getTitle:c,labelCol:p,wrapperCol:s,insertEvent:D,handleSubmit:C}}});function S(o,a,d,m,_,g){const p=u("a-input"),s=u("a-form-item"),l=u("a-col"),i=u("a-select-option"),f=u("a-select"),F=u("a-date-picker"),v=u("a-row"),B=u("vxe-button"),y=u("vxe-toolbar"),c=u("vxe-column"),D=u("vxe-table"),C=u("a-tab-pane"),n=u("a-tabs"),b=u("a-form"),k=u("BasicModal");return U(),V(k,O(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit,width:"70%"}),{default:t(()=>[e(b,{ref:"formRef",model:o.orderMainModel,"label-col":o.labelCol,"wrapper-col":o.wrapperCol,rules:o.validatorRules},{default:t(()=>[e(v,{class:"form-row",gutter:16},{default:t(()=>[e(l,{lg:8},{default:t(()=>[e(s,{label:"\u8BA2\u5355\u53F7",name:"orderCode"},{default:t(()=>[e(p,{value:o.orderMainModel.orderCode,"onUpdate:value":a[0]||(a[0]=r=>o.orderMainModel.orderCode=r),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7"},null,8,["value"])]),_:1})]),_:1}),e(l,{lg:8},{default:t(()=>[e(s,{label:"\u8BA2\u5355\u7C7B\u578B"},{default:t(()=>[e(f,{placeholder:"\u8BF7\u9009\u62E9\u8BA2\u5355\u7C7B\u578B",value:o.orderMainModel.ctype,"onUpdate:value":a[1]||(a[1]=r=>o.orderMainModel.ctype=r)},{default:t(()=>[e(i,{value:"1"},{default:t(()=>[A("\u56FD\u5185\u8BA2\u5355")]),_:1}),e(i,{value:"2"},{default:t(()=>[A("\u56FD\u9645\u8BA2\u5355")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(l,{lg:8},{default:t(()=>[e(s,{label:"\u8BA2\u5355\u65E5\u671F"},{default:t(()=>[e(F,{showTime:"",valueFormat:"YYYY-MM-DD HH:mm:ss",value:o.orderMainModel.orderDate,"onUpdate:value":a[2]||(a[2]=r=>o.orderMainModel.orderDate=r)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(v,{class:"form-row",gutter:16},{default:t(()=>[e(l,{lg:8},{default:t(()=>[e(s,{label:"\u8BA2\u5355\u91D1\u989D"},{default:t(()=>[e(p,{value:o.orderMainModel.orderMoney,"onUpdate:value":a[3]||(a[3]=r=>o.orderMainModel.orderMoney=r),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u91D1\u989D"},null,8,["value"])]),_:1})]),_:1}),e(l,{lg:8},{default:t(()=>[e(s,{label:"\u8BA2\u5355\u5907\u6CE8"},{default:t(()=>[e(p,{value:o.orderMainModel.content,"onUpdate:value":a[4]||(a[4]=r=>o.orderMainModel.content=r),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(n,{defaultActiveKey:"1"},{default:t(()=>[e(C,{tab:"\u5BA2\u6237\u4FE1\u606F",key:"1"},{default:t(()=>[e(y,null,{buttons:t(()=>[e(B,{icon:"fa fa-plus",onClick:a[5]||(a[5]=r=>o.insertEvent())},{default:t(()=>[A("\u65B0\u589E")]),_:1}),e(B,{onClick:a[6]||(a[6]=r=>o.$refs.xTable.removeCheckboxRow())},{default:t(()=>[A("\u5220\u9664\u9009\u4E2D")]),_:1})]),_:1}),e(D,{border:"","show-overflow":"","keep-source":"",ref:"xTable","max-height":"400",data:o.orderMainModel.jeecgOrderCustomerList,"edit-config":{trigger:"click",mode:"row",icon:"fa fa-pencil",showStatus:!0}},{default:t(()=>[e(c,{type:"checkbox",width:"60",align:"center"}),e(c,{type:"seq",width:"60",align:"center"}),e(c,{field:"name",title:"\u5BA2\u6237\u540D",sortable:"","edit-render":{name:"input",defaultValue:""}}),e(c,{field:"sex",title:"\u6027\u522B","edit-render":{name:"$select",options:o.sexList}},null,8,["edit-render"]),e(c,{field:"idcard",title:"\u8EAB\u4EFD\u8BC1",sortable:"","edit-render":{name:"input",defaultValue:""}}),e(c,{field:"telphone",title:"\u624B\u673A",sortable:"","edit-render":{name:"input",defaultValue:""}})]),_:1},8,["data"])]),_:1}),e(C,{tab:"\u673A\u7968\u4FE1\u606F",key:"2",forceRender:""})]),_:1})]),_:1},8,["model","label-col","wrapper-col","rules"])]),_:1},16,["onRegister","title","onOk"])}const K=h(j,[["render",S],["__scopeId","data-v-b240c9ca"]]);export{K as default};
